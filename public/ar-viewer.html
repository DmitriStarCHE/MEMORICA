<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">
    <title>WebAR Viewer</title>
    
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º A-Frame –∏ AR.js —Å CDN –∫–æ—Ç–æ—Ä—ã–π —Ç–æ—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç -->
    <script src="https://cdn.jsdelivr.net/npm/aframe@1.2.0/dist/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ar.js@3.4.0/aframe/build/aframe-ar.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #000;
            color: white;
            overflow: hidden;
            touch-action: none;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
        
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            text-align: center;
            padding: 20px;
        }
        
        .loading h1 {
            font-size: 2em;
            margin-bottom: 20px;
            color: #3498db;
        }
        
        #status {
            font-size: 1.1em;
            margin: 20px 0;
            min-height: 60px;
            max-width: 400px;
        }
        
        .error {
            background: #e74c3c;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
            max-width: 400px;
        }
        
        .instructions {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            text-align: center;
            color: white;
            background: linear-gradient(transparent, rgba(0,0,0,0.8));
            padding: 20px 10px;
            z-index: 999;
            display: none;
            font-size: 16px;
        }
        
        .camera-permission {
            background: #3498db;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            display: none;
            max-width: 400px;
        }
        
        button {
            background: #2ecc71;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            margin: 10px 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        button:hover {
            background: #27ae60;
        }
        
        .reload-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 24px;
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
            backdrop-filter: blur(10px);
            cursor: pointer;
        }
        
        .progress-bar {
            width: 300px;
            height: 6px;
            background: #333;
            border-radius: 3px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress {
            width: 0%;
            height: 100%;
            background: #3498db;
            transition: width 0.3s ease;
        }
        
        #arScene {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .tips {
            background: #34495e;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 14px;
        }
        
        .tips ul {
            text-align: left;
            margin: 10px 0;
            padding-left: 20px;
        }
    </style>
</head>
<body>
    <div class="loading" id="loading">
        <h1>üåê WebAR Viewer</h1>
        
        <div id="status">–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞...</div>
        
        <div class="progress-bar">
            <div class="progress" id="progress"></div>
        </div>
        
        <div class="camera-permission" id="cameraPermission">
            <h3>üì∑ –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ</h3>
            <p>–î–ª—è —Ä–∞–±–æ—Ç—ã AR –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –≤–∞—à–µ–π –∫–∞–º–µ—Ä–µ</p>
            <button onclick="requestCameraAccess()">–†–∞–∑—Ä–µ—à–∏—Ç—å –∫–∞–º–µ—Ä—É</button>
        </div>
        
        <div class="error" id="error"></div>
        
        <div class="tips" id="loadingTips">
            <h4>üí° –°–æ–≤–µ—Ç—ã –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:</h4>
            <ul>
                <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Chrome –Ω–∞ Android –∏–ª–∏ Safari –Ω–∞ iOS</li>
                <li>–†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ</li>
                <li>–£–±–µ–¥–∏—Ç–µ—Å—å –≤ —Ö–æ—Ä–æ—à–µ–º –æ—Å–≤–µ—â–µ–Ω–∏–∏</li>
                <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ</li>
            </ul>
        </div>
    </div>

    <button class="reload-btn" onclick="window.location.reload()">‚Üª</button>

    <div class="instructions" id="instructions">
        üéØ –ù–∞–≤–µ–¥–∏—Ç–µ –∫–∞–º–µ—Ä—É –Ω–∞ –º–∞—Ä–∫–µ—Ä –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è AR –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    </div>

    <!-- A-Frame Scene —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ -->
    <a-scene 
        embedded 
        arjs="sourceType: webcam; 
              debugUIEnabled: false; 
              detectionMode: mono; 
              matrixCodeType: 3x3; 
              maxDetectionRate: 30;
              cameraParametersUrl: https://cdn.jsdelivr.net/npm/ar.js@3.4.0/data/camera_para.dat;"
        renderer="colorManagement: true; 
                  physicallyCorrectLights: false;
                  antialias: false;
                  precision: medium;"
        vr-mode-ui="enabled: false"
        device-orientation-permission-ui="enabled: false"
        id="arScene"
        style="display: none;">
        
        <!-- –ü—Ä–æ—Å—Ç–æ–π —Å–≤–µ—Ç -->
        <a-light type="ambient" color="#FFFFFF" intensity="0.6"></a-light>
        <a-light type="directional" color="#FFFFFF" position="0 1 1" intensity="0.8"></a-light>
        
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        class WebARViewer {
            constructor() {
                this.markerId = this.getUrlParameter('marker');
                this.sceneData = null;
                this.isIOS = /iPhone|iPad|iPod/.test(navigator.userAgent);
                this.isAndroid = /Android/.test(navigator.userAgent);
                this.init();
            }

            getUrlParameter(name) {
                const urlParams = new URLSearchParams(window.location.search);
                return urlParams.get(name);
            }

            async init() {
                this.updateStatus('–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞...');
                this.updateProgress(10);
                
                if (!this.markerId) {
                    this.showError('‚ùå –û—à–∏–±–∫–∞: –Ω–µ —É–∫–∞–∑–∞–Ω ID –º–∞—Ä–∫–µ—Ä–∞<br>–î–æ–±–∞–≤—å—Ç–µ ?marker=1 –∫ URL');
                    return;
                }

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –±—Ä–∞—É–∑–µ—Ä–æ–º
                if (!this.checkBrowserSupport()) {
                    return;
                }

                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å—Ü–µ–Ω—ã
                await this.loadSceneData();
                
                // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ
                await this.requestCamera();
            }

            checkBrowserSupport() {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ API
                const hasGetUserMedia = !!navigator.mediaDevices && !!navigator.mediaDevices.getUserMedia;
                const hasWebGL = this.checkWebGLSupport();
                
                if (!hasGetUserMedia) {
                    this.showError(`
                        ‚ùå –ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ<br><br>
                        üì± –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:<br>
                        ‚Ä¢ Chrome –¥–ª—è Android<br>
                        ‚Ä¢ Safari –¥–ª—è iOS 11+<br>
                        ‚Ä¢ Firefox Mobile
                    `);
                    return false;
                }
                
                if (!hasWebGL) {
                    this.showError(`
                        ‚ùå WebGL –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è<br><br>
                        AR —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É WebGL –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å 3D –≥—Ä–∞—Ñ–∏–∫–æ–π
                    `);
                    return false;
                }
                
                console.log('‚úÖ –ë—Ä–∞—É–∑–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç WebAR');
                return true;
            }

            checkWebGLSupport() {
                try {
                    const canvas = document.createElement('canvas');
                    return !!(window.WebGLRenderingContext && 
                             (canvas.getContext('webgl') || canvas.getContext('experimental-webgl')));
                } catch (e) {
                    return false;
                }
            }

            async loadSceneData() {
                try {
                    this.updateStatus('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö AR...');
                    this.updateProgress(30);
                    
                    const response = await fetch(`/api/ar-scene/${this.markerId}`);
                    
                    if (!response.ok) {
                        throw new Error(`–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: ${response.status}`);
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –æ—Ç–≤–µ—Ç JSON
                    const contentType = response.headers.get('content-type');
                    if (!contentType || !contentType.includes('application/json')) {
                        const text = await response.text();
                        throw new Error(`–°–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ`);
                    }
                    
                    this.sceneData = await response.json();
                    
                    if (!this.sceneData.marker) {
                        throw new Error('–ú–∞—Ä–∫–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω');
                    }
                    
                    console.log('‚úÖ –î–∞–Ω–Ω—ã–µ —Å—Ü–µ–Ω—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', this.sceneData);
                    this.updateProgress(60);
                    
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                    this.showError(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: ${error.message}`);
                }
            }

            async requestCamera() {
                this.updateStatus('–ó–∞–ø—Ä–æ—Å –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–º–µ—Ä–µ...');
                this.updateProgress(80);
                
                try {
                    // –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–º–µ—Ä–µ
                    const stream = await navigator.mediaDevices.getUserMedia({ 
                        video: {
                            facingMode: 'environment',
                            width: { ideal: 640 },
                            height: { ideal: 480 }
                        }
                    });
                    
                    // –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º stream
                    stream.getTracks().forEach(track => track.stop());
                    
                    console.log('‚úÖ –î–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ —Ä–∞–∑—Ä–µ—à–µ–Ω');
                    this.updateProgress(100);
                    
                    // –î–∞–µ–º –≤—Ä–µ–º—è –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
                    setTimeout(() => {
                        this.setupARScene();
                    }, 500);
                    
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–º–µ—Ä–µ:', error);
                    
                    if (error.name === 'NotAllowedError') {
                        this.showCameraPermissionRequest();
                    } else if (error.name === 'NotFoundError') {
                        this.showError('üì∑ –ö–∞–º–µ—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ');
                    } else if (error.name === 'NotSupportedError') {
                        this.showError('üì∑ –ö–∞–º–µ—Ä–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
                    } else {
                        this.showError(`–û—à–∏–±–∫–∞ –∫–∞–º–µ—Ä—ã: ${error.message}`);
                    }
                }
            }

            showCameraPermissionRequest() {
                document.getElementById('cameraPermission').style.display = 'block';
                this.updateStatus('–û–∂–∏–¥–∞–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–º–µ—Ä–µ...');
            }

            setupARScene() {
                this.updateStatus('–ó–∞–ø—É—Å–∫ AR —Å—Ü–µ–Ω—ã...');
                
                const scene = document.getElementById('arScene');
                
                // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –º–∞—Ä–∫–µ—Ä—ã
                const oldMarkers = scene.querySelectorAll('a-marker');
                oldMarkers.forEach(marker => marker.remove());

                // –°–æ–∑–¥–∞–µ–º –º–∞—Ä–∫–µ—Ä —Å —É–ø—Ä–æ—â–µ–Ω–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
                const marker = document.createElement('a-marker');
                marker.setAttribute('type', 'pattern');
                marker.setAttribute('url', this.sceneData.marker.pattUrl);
                marker.setAttribute('emitevents', 'true');
                marker.setAttribute('smooth', 'false'); // –û—Ç–∫–ª—é—á–∞–µ–º —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

                // –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –∏–ª–∏ —Ç–µ—Å—Ç–æ–≤—ã–π –æ–±—ä–µ–∫—Ç
                if (this.sceneData.contents && this.sceneData.contents.length > 0) {
                    console.log(`‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ ${this.sceneData.contents.length} –æ–±—ä–µ–∫—Ç–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞`);
                    this.sceneData.contents.forEach((content, index) => {
                        const entity = this.createOptimizedContentEntity(content, index);
                        marker.appendChild(entity);
                    });
                } else {
                    console.log('‚ÑπÔ∏è –ö–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω, –¥–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π –∫—É–±');
                    // –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç–æ–≤—ã–π –∫—É–±
                    const testCube = document.createElement('a-box');
                    testCube.setAttribute('position', '0 0.5 0');
                    testCube.setAttribute('color', '#4CC3D9');
                    testCube.setAttribute('scale', '0.3 0.3 0.3');
                    marker.appendChild(testCube);
                }

                scene.appendChild(marker);

                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
                marker.addEventListener('markerFound', () => {
                    console.log('üéØ –ú–∞—Ä–∫–µ—Ä —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω!');
                    document.getElementById('instructions').style.display = 'block';
                });

                marker.addEventListener('markerLost', () => {
                    console.log('üîç –ú–∞—Ä–∫–µ—Ä –ø–æ—Ç–µ—Ä—è–Ω');
                });

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ü–µ–Ω—É
                scene.style.display = 'block';
                
                // –°–∫—Ä—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
                setTimeout(() => {
                    this.hideLoading();
                }, 1000);

                // –¢–∞–π–º–∞—É—Ç –Ω–∞ —Å–ª—É—á–∞–π –ø—Ä–æ–±–ª–µ–º
                setTimeout(() => {
                    if (document.getElementById('loading').style.display !== 'none') {
                        this.showError('‚ö†Ô∏è –î–æ–ª–≥–∞—è –∑–∞–≥—Ä—É–∑–∫–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
                    }
                }, 15000);
            }

            createOptimizedContentEntity(content, index) {
                const entity = document.createElement('a-entity');
                
                switch (content.contentType) {
                    case 'model':
                        entity.setAttribute('gltf-model', {
                            src: content.contentUrl,
                            onError: this.onModelError.bind(this)
                        });
                        break;
                        
                    case 'video':
                        entity.setAttribute('geometry', 'primitive: plane; width: 1.0; height: 0.6');
                        entity.setAttribute('material', {
                            src: content.contentUrl,
                            transparent: true
                        });
                        break;
                        
                    case 'image':
                        entity.setAttribute('geometry', 'primitive: plane; width: 1.0; height: 1.0');
                        entity.setAttribute('material', {
                            src: content.contentUrl
                        });
                        break;
                }

                // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
                entity.setAttribute('position', content.position);
                entity.setAttribute('scale', content.scale);
                entity.setAttribute('rotation', content.rotation);

                return entity;
            }

            onModelError(evt) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ 3D –º–æ–¥–µ–ª–∏:', evt.detail);
            }

            updateStatus(message) {
                document.getElementById('status').textContent = message;
                console.log('üìù Status:', message);
            }

            updateProgress(percent) {
                document.getElementById('progress').style.width = percent + '%';
            }

            hideLoading() {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('instructions').style.display = 'block';
                console.log('‚úÖ AR —Å—Ü–µ–Ω–∞ –≥–æ—Ç–æ–≤–∞');
            }

            showError(message) {
                document.getElementById('error').innerHTML = message;
                document.getElementById('error').style.display = 'block';
                document.getElementById('status').style.display = 'none';
                document.getElementById('progress').style.background = '#e74c3c';
            }
        }

        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –∫–∞–º–µ—Ä—ã
        function requestCameraAccess() {
            location.reload();
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', () => {
            new WebARViewer();
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ—à–∏–±–æ–∫ AR.js
        window.addEventListener('arjs-nft-loaded', (e) => {
            console.log('‚úÖ AR.js NFT –∑–∞–≥—Ä—É–∂–µ–Ω');
        });

        window.addEventListener('arjs-video-loaded', (e) => {
            console.log('‚úÖ –í–∏–¥–µ–æ –¥–ª—è AR –∑–∞–≥—Ä—É–∂–µ–Ω–æ');
        });

        window.addEventListener('arjs-error', (e) => {
            console.error('‚ùå AR.js –æ—à–∏–±–∫–∞:', e.detail);
        });

        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
        document.addEventListener('touchmove', (e) => {
            if (e.scale !== 1) {
                e.preventDefault();
            }
        }, { passive: false });
    </script>
</body>
</html>